<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>history</title>
		<title>commodity</title>
		<link rel="stylesheet" type="text/css" href="css/grzx.css"/>
		<link rel="stylesheet" href="css/commodity.css" />
		<link rel="stylesheet" href="../public/css/bootstrap.css" />
		<script type="text/javascript" src="../public/js/vue.js" ></script>
		<script type="text/javascript" src="../public/js/ajaxUtil.js" ></script>
		<script type="text/javascript" src="../public/js/jquery-1.12.4.js" ></script>
	</head>
	<body>
		
		<div class="header">
			<p>超市管理系统</p>
		</div>
		
		<div class="center">
			<div class="center_of_left">
				<div id="Personal_management">
					<p><a href="/zbl/supermarket_pcenter.html" >个人中心&gt;</a></p>
				</div>
				<div id="Commodity_management">
					<p><a href="#" class="nav-item">商品管理&gt;</a></p>
				</div>
				<div id="Staff_management">
					<p>	<a href="/ych/supermarket_manager.html">员工管理&gt;</a></p>
				</div>
			</div>
		
		
			<div id="center_of_right" style="display: flex;">
				<table class="table table-hover table-striped">
					<thead>
						<tr>
							<th>出库单号</th>
							<th>出库商品号</th>
							<th>出库日期</th>
							<th>查看详情</th>
						</tr>
					</thead>
					<tbody id="tbody">
						<tr v-for="item in items">
							<td>{{item.num}}</td>
							<td>{{item.cnum}}</td>
							<td>{{item.outdate}}</td>
							<td>
								<a :href="`/sry/StockOut_details.html?num=${item.num}`">详情</a>
							</td>
						</tr>
					</tbody>
				</table>
			</div>
			
			<div>
				<button class="btn btn-success" id="page_up">上一页</button>
				第<span style="margin: 10px;" id="page">1</span>页
				<button class="btn btn-success" id="page_down">下一页</button>
			</div>
			
		</div>
	</body>
	
	<script type="text/javascript">
		
    	var reg = new RegExp("(^|&)" + "page" + "=([^&]*)(&|$)"); //构造一个含有目标参数的正则表达式对象
    	var r = window.location.search.substr(1).match(reg);  //匹配目标参数
    	var page =  unescape(r[2]);
		
		document.getElementById("page").innerHTML = page
		
		var v1 = new Vue({
			el: '#tbody',
			data: {
				items: []
			},
			mounted() {
					this.getInfo();
			},
			methods: {
				getInfo() {
					ajax({
						method: HTTP_METHOD.GET, 
				   		url: "/stockOut/history?page="+page, 
				   		async: true, 
				   		type: HTTP_RESPONSE_TYPE.JSON, 
				   		callback: (datas) => {
				   			this.items = datas
				   		}
			   		})
				}
			}
		})
		
		document.getElementById("page_up").onclick = function() {
			if (page > 1) {
				page--;
				location.replace("/ljy/historyStockOut.html?page="+page);
			} else {
				
			}
		}
		
		document.getElementById("page_down").onclick = function() {
			if (v1.items.length == 10) {
				page++;
				location.replace("/ljy/historyStockOut.html?page="+page);
			} else {
				
			}
		}
		
	</script>
	
</html>
